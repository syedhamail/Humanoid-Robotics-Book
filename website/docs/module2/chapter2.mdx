---
title: "Gazebo Setup & Scene Configuration"
description: Configuring Gazebo simulation environments for humanoid robotics applications
---

import DocCardList from '@theme/DocCardList';

## Learning Objectives

After completing this chapter, you will be able to:
- Install and configure Gazebo for humanoid robotics simulation
- Create and configure Gazebo world files with appropriate physics properties
- Set up humanoid robot models in Gazebo with proper plugins
- Configure sensors and actuators for simulation
- Optimize simulation performance for real-time operation

## Prerequisites

Before starting this chapter, you should:
- Have completed Module 1 on ROS 2 fundamentals and robot control
- Understand URDF and robot modeling concepts from Chapter 1.4
- Be familiar with Linux command line and file systems
- Have basic knowledge of 3D coordinate systems and transformations

## Introduction

Gazebo is a powerful 3D simulation environment that plays a crucial role in humanoid robotics development. It provides realistic physics simulation, high-quality graphics, and sensor simulation capabilities that are essential for testing humanoid robot algorithms before deployment on real hardware.

For humanoid robotics, Gazebo offers several key advantages:
- Accurate physics simulation for dynamic balance and locomotion
- Support for complex kinematic structures with many degrees of freedom
- Integration with ROS 2 for seamless control and perception
- Extensive sensor simulation capabilities (LiDAR, cameras, IMUs, etc.)
- Flexible world creation and customization

This chapter will guide you through setting up Gazebo for humanoid robotics applications, from basic installation to advanced scene configuration.

## Core Concepts

### Gazebo Architecture

Gazebo consists of several key components:
- **Gazebo Server**: Runs the physics simulation and handles all simulation logic
- **Gazebo Client**: Provides the graphical user interface for visualization
- **Model Database**: Contains pre-built models and environments
- **Plugin System**: Extends functionality for custom behaviors and ROS 2 integration

### World Files (SDF Format)

Gazebo uses SDF (Simulation Description Format) to define simulation worlds:
- **World Elements**: Define the overall simulation environment
- **Model Elements**: Specify robot and object models in the scene
- **Physics Engines**: Configure simulation parameters (ODE, Bullet, Simbody)
- **Lighting**: Set up environmental lighting and shadows
- **Plugins**: Add custom simulation behaviors

### Robot-World Integration

For humanoid robots in Gazebo:
- URDF models are converted to SDF format for simulation
- Joint controllers connect ROS 2 nodes to Gazebo physics
- Sensor plugins provide simulated sensor data
- Collision detection handles robot-environment interactions

### Performance Considerations

Gazebo performance depends on:
- Complexity of physics models (mesh vs primitive shapes)
- Number of objects and robots in the scene
- Physics engine parameters (time step, iterations)
- Graphics settings and visualization quality

## Code Examples

### Basic Gazebo World Configuration

```xml
<?xml version="1.0" ?>
<sdf version="1.7">
  <world name="humanoid_world">
    <!-- Physics engine configuration -->
    <physics type="ode">
      <max_step_size>0.001</max_step_size>
      <real_time_factor>1.0</real_time_factor>
      <real_time_update_rate>1000.0</real_time_update_rate>
      <gravity>0 0 -9.8</gravity>

      <!-- ODE-specific parameters -->
      <ode>
        <solver>
          <type>quick</type>
          <iters>100</iters>
          <sor>1.3</sor>
        </solver>
        <constraints>
          <cfm>0.0</cfm>
          <erp>0.2</erp>
          <contact_max_correcting_vel>100.0</contact_max_correcting_vel>
          <contact_surface_layer>0.001</contact_surface_layer>
        </constraints>
      </ode>
    </physics>

    <!-- Environment lighting -->
    <light name="sun" type="directional">
      <cast_shadows>true</cast_shadows>
      <pose>0 0 10 0 0 0</pose>
      <diffuse>0.8 0.8 0.8 1</diffuse>
      <specular>0.2 0.2 0.2 1</specular>
      <attenuation>
        <range>1000</range>
        <constant>0.9</constant>
        <linear>0.01</linear>
        <quadratic>0.001</quadratic>
      </attenuation>
      <direction>-0.4 0.2 -1.0</direction>
    </light>

    <!-- Ground plane -->
    <model name="ground_plane">
      <static>true</static>
      <link name="link">
        <collision name="collision">
          <geometry>
            <plane>
              <normal>0 0 1</normal>
              <size>100 100</size>
            </plane>
          </geometry>
          <surface>
            <friction>
              <ode>
                <mu>1.0</mu>
                <mu2>1.0</mu2>
              </ode>
            </friction>
          </surface>
        </collision>

        <visual name="visual">
          <geometry>
            <plane>
              <normal>0 0 1</normal>
              <size>100 100</size>
            </plane>
          </geometry>
          <material>
            <ambient>0.7 0.7 0.7 1</ambient>
            <diffuse>0.7 0.7 0.7 1</diffuse>
            <specular>0.7 0.7 0.7 1</specular>
          </material>
        </visual>
      </link>
    </model>

    <!-- Example humanoid robot (will be spawned separately via ROS) -->
    <!-- Plugins for ROS 2 integration -->
    <plugin name="gazebo_ros_init" filename="libgazebo_ros_init.so">
      <ros>
        <namespace>/Gazebo</namespace>
      </ros>
      <update_rate>1000</update_rate>
    </plugin>

    <plugin name="gazebo_ros_factory" filename="libgazebo_ros_factory.so">
      <ros>
        <namespace>/Gazebo</namespace>
      </ros>
    </plugin>
  </world>
</sdf>
```

### Robot Model Configuration with Gazebo Plugins

```xml
<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="humanoid_with_gazebo_plugins">

  <!-- Include common properties -->
  <xacro:property name="M_PI" value="3.1415926535897931" />

  <!-- Base link -->
  <link name="base_link">
    <inertial>
      <mass value="10.0" />
      <origin xyz="0 0 0.5" />
      <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="1.0" iyz="0.0" izz="1.0" />
    </inertial>

    <visual>
      <origin xyz="0 0 0.5" />
      <geometry>
        <box size="0.3 0.3 1.0" />
      </geometry>
      <material name="blue">
        <color rgba="0 0 1 0.8" />
      </material>
    </visual>

    <collision>
      <origin xyz="0 0 0.5" />
      <geometry>
        <box size="0.3 0.3 1.0" />
      </geometry>
    </collision>
  </link>

  <!-- Hip joint and right leg -->
  <joint name="right_hip_joint" type="revolute">
    <parent link="base_link" />
    <child link="right_thigh" />
    <origin xyz="0 -0.2 -0.5" rpy="0 0 0" />
    <axis xyz="0 0 1" />
    <limit lower="${-M_PI/2}" upper="${M_PI/2}" effort="100" velocity="2.0" />
    <dynamics damping="1.0" friction="0.1" />
  </joint>

  <link name="right_thigh">
    <inertial>
      <mass value="5.0" />
      <origin xyz="0 0 -0.25" />
      <inertia ixx="0.1" ixy="0.0" ixz="0.0" iyy="0.1" iyz="0.0" izz="0.05" />
    </inertial>

    <visual>
      <origin xyz="0 0 -0.25" />
      <geometry>
        <capsule radius="0.08" length="0.5" />
      </geometry>
      <material name="white">
        <color rgba="1 1 1 0.8" />
      </material>
    </visual>

    <collision>
      <origin xyz="0 0 -0.25" />
      <geometry>
        <capsule radius="0.08" length="0.5" />
      </geometry>
    </collision>
  </link>

  <!-- Gazebo plugins for ROS 2 control -->
  <Gazebo reference="base_link">
    <material>Gazebo/Blue</material>
  </Gazebo>

  <Gazebo reference="right_thigh">
    <material>Gazebo/White</material>
  </Gazebo>

  <!-- Transmission for joint control -->
  <transmission name="right_hip_transmission" type="SimpleTransmission">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="right_hip_joint">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
    </joint>
    <actuator name="right_hip_motor">
      <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>

  <!-- Gazebo control plugin -->
  <Gazebo>
    <plugin name="gazebo_ros_control" filename="libgazebo_ros2_control.so">
      <robot_namespace>/humanoid</robot_namespace>
      <robot_param>/robot_description</robot_param>
      <robot_param_node>/robot_state_publisher</robot_param_node>
      <parameters>$(find my_robot_description)/config/humanoid_control.yaml</parameters>
    </plugin>
  </Gazebo>

</robot>
```

### Gazebo Control Configuration

```yaml
# config/humanoid_control.yaml
humanoid:
  # Joint state broadcaster
  joint_state_broadcaster:
    type: joint_state_broadcaster/JointStateBroadcaster

  # Individual joint controllers
  right_hip_controller:
    type: effort_controllers/JointPositionController
    joint: right_hip_joint
    pid:
      p: 100.0
      i: 0.01
      d: 10.0

  # Effort controller for more complex control
  right_leg_controller:
    type: effort_controllers/JointEffortController
    joint: right_hip_joint